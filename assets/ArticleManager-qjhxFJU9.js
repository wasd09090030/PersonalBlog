import{_ as $,b as o,e as _,j as a,d as t,t as u,g as k,r as c,o as E,l as M,F as B,h as N,E as f,a as S}from"./index-BvN9veIB.js";import{a as h}from"./articleService-D2l59cck.js";const T={key:0,class:"confirm-modal-backdrop"},V={class:"modal-dialog"},I={class:"modal-content"},j={class:"modal-header"},F={class:"modal-title"},L={class:"modal-body"},z={class:"modal-footer"},P=["disabled"],R={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},q={__name:"ConfirmModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"确认操作"},message:{type:String,default:"确定要执行此操作吗？"},loading:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(i){return(r,s)=>i.show?(a(),o("div",T,[t("div",V,[t("div",I,[t("div",j,[t("h5",F,u(i.title),1),t("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=d=>r.$emit("cancel"))})]),t("div",L,[t("p",null,u(i.message),1)]),t("div",z,[t("button",{type:"button",class:"btn btn-secondary",onClick:s[1]||(s[1]=d=>r.$emit("cancel"))}," 取消 "),t("button",{type:"button",class:"btn btn-danger",onClick:s[2]||(s[2]=d=>r.$emit("confirm")),disabled:i.loading},[i.loading?(a(),o("span",R)):_("",!0),s[3]||(s[3]=k(" 确认删除 "))],8,P)])])])])):_("",!0)}},G=$(q,[["__scopeId","data-v-c1093b2e"]]),H={class:"article-manager"},J={class:"card"},K={class:"card-body"},O={key:0,class:"text-center py-4"},Q={key:1,class:"text-center py-4 text-muted"},U={key:2,class:"table-responsive"},W={class:"table table-hover"},X={class:"btn-group btn-group-sm"},Y=["onClick"],Z=["onClick"],tt=["href"],et={__name:"ArticleManager",setup(i){const r=S(),s=c([]),d=c(!0),b=c(!1),m=c(null),v=c(!1),p=l=>l?new Date(l).toLocaleDateString("zh-CN"):"-",g=async()=>{d.value=!0;try{s.value=await h.getArticles()}catch(l){console.error("获取文章列表失败:",l),f("获取文章列表失败","danger")}finally{d.value=!1}},C=()=>{r.push({name:"ArticleEditor"})},A=l=>{r.push({name:"ArticleEditorEdit",params:{id:l.id}})},w=l=>{m.value=l,b.value=!0},D=async()=>{v.value=!0;try{await h.deleteArticle(m.value.id),b.value=!1,m.value=null,g(),f("文章已成功删除","success")}catch(l){console.error("删除文章失败:",l),f("删除文章失败","danger")}finally{v.value=!1}};return E(()=>{g()}),(l,e)=>{var y;return a(),o("div",H,[t("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e[2]||(e[2]=t("h2",null,"文章管理",-1)),t("button",{class:"btn btn-primary",onClick:C},e[1]||(e[1]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),k("新建文章 ")]))]),t("div",J,[t("div",K,[d.value?(a(),o("div",O,e[3]||(e[3]=[t("div",{class:"spinner-border text-primary",role:"status"},null,-1)]))):s.value.length===0?(a(),o("div",Q," 暂无文章 ")):(a(),o("div",U,[t("table",W,[e[7]||(e[7]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"标题"),t("th",null,"创建时间"),t("th",null,"更新时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(a(!0),o(B,null,N(s.value,n=>(a(),o("tr",{key:n.id},[t("td",null,u(n.id),1),t("td",null,u(n.title),1),t("td",null,u(p(n.createdAt)),1),t("td",null,u(p(n.updatedAt)),1),t("td",null,[t("div",X,[t("button",{class:"btn btn-outline-primary",onClick:x=>A(n),title:"编辑"},e[4]||(e[4]=[t("i",{class:"bi bi-pencil"},null,-1)]),8,Y),t("button",{class:"btn btn-outline-danger",onClick:x=>w(n),title:"删除"},e[5]||(e[5]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Z),t("a",{href:`/article/${n.id}`,target:"_blank",class:"btn btn-outline-info",title:"预览"},e[6]||(e[6]=[t("i",{class:"bi bi-eye"},null,-1)]),8,tt)])])]))),128))])])]))])]),M(G,{show:b.value,title:"确认删除",message:`确定要删除文章《${(y=m.value)==null?void 0:y.title}》吗？此操作不可恢复。`,loading:v.value,onConfirm:D,onCancel:e[0]||(e[0]=n=>b.value=!1)},null,8,["show","message","loading"])])}}},nt=$(et,[["__scopeId","data-v-cfa7fa14"]]);export{nt as default};
