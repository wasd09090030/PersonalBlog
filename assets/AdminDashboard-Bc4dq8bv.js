import{_ as x,r as m,o as k,b as o,d as s,l as v,t as d,m as _,g as c,i as w,e as C,F as A,h as D,a as N,j as a}from"./index-BvN9veIB.js";import{a as j}from"./articleService-D2l59cck.js";const R={class:"admin-dashboard"},S={class:"row"},V={class:"col-md-6 col-lg-3 mb-4"},B={class:"card shadow-sm h-100"},$={class:"card-body"},E={key:0,class:"text-center"},F={key:1,class:"d-flex align-items-center"},L={class:"display-4 me-2"},z={class:"col-md-6 col-lg-3 mb-4"},I={class:"card shadow-sm h-100"},M={class:"card-body"},T={class:"list-group list-group-flush"},q={class:"col-md-6 col-lg-3 mb-4"},G={class:"card shadow-sm h-100"},H={class:"card-body"},J={key:0,class:"text-center"},K={key:1},O={class:"d-flex align-items-center mb-2"},P={class:"display-4 me-2"},Q={key:0,class:"text-warning mb-2"},U={class:"col-md-12 col-lg-6 mb-4"},W={class:"card shadow-sm h-100"},X={class:"card-body"},Y={key:0,class:"text-center py-4"},Z={key:1,class:"text-center py-4 text-muted"},tt={key:2,class:"list-group list-group-flush"},st=["href"],et={class:"text-truncate me-3"},ot={class:"text-muted"},at={__name:"AdminDashboard",setup(lt){const h=N(),n=m(!0),p=m(0),u=m([]),i=m({total:0,pending:0}),b=e=>e?new Date(e).toLocaleDateString("zh-CN"):"-",g=()=>{h.push({name:"ArticleEditor"})},y=async()=>{n.value=!0;try{const e=await j.getArticles();e&&(p.value=Array.isArray(e)?e.length:0,u.value=Array.isArray(e)?e.slice(0,5):[]),await f()}catch(e){console.error("获取仪表板数据失败:",e)}finally{n.value=!1}},f=async()=>{try{const e=await fetch("http://localhost:3000/comments/admin/all");if(e.ok){const l=await e.json();i.value.total=l.length}const t=await fetch("http://localhost:3000/comments/admin/pending");if(t.ok){const l=await t.json();i.value.pending=l.length}}catch(e){console.error("获取评论统计失败:",e)}};return k(()=>{y()}),(e,t)=>{const l=w("router-link");return a(),o("div",R,[t[15]||(t[15]=s("h2",{class:"mb-4"},"仪表板",-1)),s("div",S,[s("div",V,[s("div",B,[s("div",$,[t[4]||(t[4]=s("h5",{class:"card-title"},"文章统计",-1)),n.value?(a(),o("div",E,t[1]||(t[1]=[s("div",{class:"spinner-border text-primary",role:"status"},null,-1)]))):(a(),o("div",F,[s("span",L,d(p.value),1),t[2]||(t[2]=s("span",{class:"text-muted"},"篇",-1))])),v(l,{to:"/admin/articles",class:"btn btn-sm btn-outline-primary mt-3"},{default:_(()=>t[3]||(t[3]=[c(" 管理文章 ")])),_:1})])])]),s("div",z,[s("div",I,[s("div",M,[t[7]||(t[7]=s("h5",{class:"card-title"},"快速操作",-1)),s("div",T,[s("button",{class:"list-group-item list-group-item-action",onClick:t[0]||(t[0]=r=>e.$router.push("/admin/articles"))},t[5]||(t[5]=[s("i",{class:"bi bi-list me-2"},null,-1),c("查看所有文章 ")])),s("button",{class:"list-group-item list-group-item-action",onClick:g},t[6]||(t[6]=[s("i",{class:"bi bi-plus-circle me-2"},null,-1),c("创建新文章 ")]))])])])]),s("div",q,[s("div",G,[s("div",H,[t[12]||(t[12]=s("h5",{class:"card-title"},"评论统计",-1)),n.value?(a(),o("div",J,t[8]||(t[8]=[s("div",{class:"spinner-border text-primary",role:"status"},null,-1)]))):(a(),o("div",K,[s("div",O,[s("span",P,d(i.value.total),1),t[9]||(t[9]=s("span",{class:"text-muted"},"条",-1))]),i.value.pending>0?(a(),o("div",Q,[t[10]||(t[10]=s("i",{class:"bi bi-exclamation-triangle me-1"},null,-1)),c(" "+d(i.value.pending)+" 条待审核 ",1)])):C("",!0)])),v(l,{to:"/admin/comments",class:"btn btn-sm btn-outline-primary mt-3"},{default:_(()=>t[11]||(t[11]=[c(" 管理评论 ")])),_:1})])])]),s("div",U,[s("div",W,[s("div",X,[t[14]||(t[14]=s("h5",{class:"card-title"},"最近文章",-1)),n.value?(a(),o("div",Y,t[13]||(t[13]=[s("div",{class:"spinner-border text-primary",role:"status"},null,-1)]))):u.value.length===0?(a(),o("div",Z," 暂无文章 ")):(a(),o("div",tt,[(a(!0),o(A,null,D(u.value,r=>(a(),o("a",{key:r.id,href:`/article/${r.id}`,target:"_blank",class:"list-group-item list-group-item-action d-flex justify-content-between align-items-center"},[s("span",et,d(r.title),1),s("small",ot,d(b(r.createdAt)),1)],8,st))),128))]))])])])])])}}},rt=x(at,[["__scopeId","data-v-5aa78c2b"]]);export{rt as default};
